var_r6
# ssc+structure
rock_test7 <- randomForest(Unsaturated_K2cm_cmhr ~ SAND + SILT + CLAY + Top_Type, data=rock_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
# train dataset
rock_test_data$rock_m7 <- predict(rock_test7, rock_test_data)
cor(rock_test_data$rock_m7, rock_test_data$Unsaturated_K2cm_cmhr, method = c("spearman"))
summary(lm(rock_test_data$Unsaturated_K2cm_cmhr ~ rock_test_data$rock_m7))$r.squared %>%
round(2)->
var_r7
# sscr+structure
rock_test8 <- randomForest(Unsaturated_K2cm_cmhr ~ SAND + SILT + CLAY + ROCK + Top_Type, data=rock_test_data3,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
# train dataset
rock_test_data3$rock_m8 <- predict(rock_test8, rock_test_data3)
cor(rock_test_data3$rock_m8, rock_test_data3$Unsaturated_K2cm_cmhr, method = c("spearman"))
summary(lm(rock_test_data3$Unsaturated_K2cm_cmhr ~ rock_test_data3$rock_m8))$r.squared %>%
round(2)->
var_r8
bind_rows(rock_test_data %>%
mutate(Model = paste0("(a) ssc (ssc=100%, R^2=",var_r1,")"),
Predict = rock_m1) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data %>%
mutate(Model = paste0("(b) sscr (ssc=100%, R^2=",var_r2,")"),
Predict = rock_m2) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data3 %>%
mutate(Model = paste0("(c) sscr (sscr=100%, R^2=",var_r3,")"),
Predict = rock_m3) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data4 %>%
mutate(Model = paste0("(d) sscr (no scale, R^2=",var_r4,")"),
Predict = rock_m4) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data %>%
mutate(Model = paste0("(e) sscg (ssc=100%, R^2=",var_r5,")"),
Predict = rock_m5) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data %>%
mutate(Model = paste0("(f) sscbd (ssc=100%, R^2=",var_r6,")"),
Predict = rock_m6) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data %>%
mutate(Model = paste0("(g) sscstr (ssc=100%, R^2=",var_r7,")"),
Predict = rock_m7) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model),
rock_test_data3 %>%
mutate(Model = paste0("(h) sscrstr (ssc=100%, R^2=",var_r8,")"),
Predict = rock_m8) %>%
select(Unsaturated_K2cm_cmhr, Predict, Model)
) %>%
ggplot(aes(Predict, Unsaturated_K2cm_cmhr)) +
geom_point(alpha = 0.5) +
geom_smooth(method = "lm") +
facet_wrap(. ~ Model, nrow = 4) +
labs(x = expression(Predicted~K[fs]~(cm~hr^{-1}~","~log~transfered)),
y = expression(Measured~K[fs]~(cm~hr^{-1}~","~log~transfered)))
# ggsave("Figure A3.jpg", width = 6, height = 7, dpi = 300, units = "in")
# stepwise
# library(MASS)
clean_data_rock(data_orig) %>%
na.omit() %>%
dplyr::select(CLAY, SILT, SAND, Unsaturated_K2cm_cmhr, ROCK, BD) ->
data_structure2
# Fit the full model
full.model <- lm(Unsaturated_K2cm_cmhr ~., data = data_structure2)
# Stepwise regression model
step.model <- MASS::stepAIC(full.model, direction = "both",
trace = FALSE)
summary(step.model)
summary(full.model)
all_city_joint_bd %>%
select(Percent_Sand, Percent_Silt, Percent_Clay, Unsaturated_K2cm_cmhr, Type) %>%
mutate(ssc = Percent_Sand + Percent_Silt + Percent_Clay) %>%
na.omit() %>%
arrange(ssc)
rock_test_data4 %>%
ggplot(aes(Percent_Rock_Fragment, Unsaturated_K2cm_cmhr, col = Rock_group)) +
geom_point() +
# geom_hex(bins = 30) +
# scale_fill_distiller(palette = "YlGnBu", name = "Count") +
labs(x = expression(Rock~fragment~("%")),
y = expression(K[fs]*","~'log'~(cm~h^{-1}))) +
scale_color_discrete(name = element_blank()) +
# scale_fill_continuous(name = element_blank()) +
guides(fill = FALSE) +
theme(legend.position = "right") ->
p1
# density 1 panel
rock_test_data4 %>%
ggplot(aes(Percent_Rock_Fragment)) +
geom_histogram(bins = 50, fill = "white", col = "black") +
theme_void() ->
dens1
# density 2 panel
rock_test_data4 %>%
ggplot(aes(Unsaturated_K2cm_cmhr)) +
geom_histogram(bins = 25, fill = "white", col = "black") +
theme_void() +
coord_flip() ->
dens2
dens1 + plot_spacer() + p1 + dens2 +
plot_layout(
ncol = 2,
nrow = 2,
widths = c(4, 1),
heights = c(1, 4) ) ->
final_plot
print(final_plot)
# ggsave("Figure A4.jpg", width = 6, height = 4, dpi = 300, units = "in")
rock_test_data4$Percent_Rock_Fragment %>% max()
all_city_joint_bd %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
bd_test_data %>%
mutate(log_kfs = log(Unsaturated_K2cm_cmhr)) ->
bd_test_data
# density 1 panel
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3)) +
geom_histogram(bins = 30, fill = "white", col = "black") +
theme_void() ->
dens_bd1
# density 2 panel
bd_test_data %>%
ggplot(aes(log_kfs)) +
geom_histogram(bins = 20, fill = "white", col = "black") +
theme_void() +
coord_flip() ->
dens_bd2
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3, log_kfs)) +
# geom_point() +
geom_hex(col = "gray", bins = 25) +
scale_fill_distiller(palette = "YlGnBu", name = "Count") +
labs(x = expression(Bulk~density~(g~cm^{-3})),
y = expression(K[fs]*","~log~(cm~h^{-1}))) ->
p2
dens_bd1 + plot_spacer() + p2 + dens_bd2 +
dens1 + plot_spacer() + p1 + dens2 +
plot_layout(
ncol = 2,
nrow = 4,
widths = c(4, 1),
heights = c(1, 4) ) ->
final_plot_bd
print(final_plot_bd)
bd_test_data
read.csv(here::here("extdata/AllCities_Victoria_RDS_rock_bd.csv"))
data_orig <- update_structure(read.csv(here::here("extdata/AllCities_Victoria_RDS_rock_bd.csv")))
data_orig
data_orig %>%
select(BulkDensity_gcm3) %>%
na.omit()
bd_test_data
data_orig %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
bd_test_data
data_orig %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
bd_test_data %>%
mutate(log_kfs = log(Unsaturated_K2cm_cmhr)) ->
bd_test_data
# density 1 panel
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3)) +
geom_histogram(bins = 30, fill = "white", col = "black") +
theme_void() ->
dens_bd1
# density 2 panel
bd_test_data %>%
ggplot(aes(log_kfs)) +
geom_histogram(bins = 20, fill = "white", col = "black") +
theme_void() +
coord_flip() ->
dens_bd2
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3, log_kfs)) +
# geom_point() +
geom_hex(col = "gray", bins = 25) +
scale_fill_distiller(palette = "YlGnBu", name = "Count") +
labs(x = expression(Bulk~density~(g~cm^{-3})),
y = expression(K[fs]*","~log~(cm~h^{-1}))) ->
p2
dens_bd1 + plot_spacer() + p2 + dens_bd2 +
dens1 + plot_spacer() + p1 + dens2 +
plot_layout(
ncol = 2,
nrow = 4,
widths = c(4, 1),
heights = c(1, 4) ) ->
final_plot_bd
print(final_plot_bd)
# ggsave("Figure A4_V2.jpg", width = 6, height = 7, dpi = 300, units = "in")
bd_test_data
data_orig %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture) & !is.na(BulkDensity_gcm3)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
data_orig %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture) & !is.na(BulkDensity_gcm3)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
bd_test_data %>%
mutate(log_kfs = log(Unsaturated_K2cm_cmhr)) ->
bd_test_data
# density 1 panel
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3)) +
geom_histogram(bins = 30, fill = "white", col = "black") +
theme_void() ->
dens_bd1
# density 2 panel
bd_test_data %>%
ggplot(aes(log_kfs)) +
geom_histogram(bins = 20, fill = "white", col = "black") +
theme_void() +
coord_flip() ->
dens_bd2
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3, log_kfs)) +
# geom_point() +
geom_hex(col = "gray", bins = 25) +
scale_fill_distiller(palette = "YlGnBu", name = "Count") +
labs(x = expression(Bulk~density~(g~cm^{-3})),
y = expression(K[fs]*","~log~(cm~h^{-1}))) ->
p2
dens_bd1 + plot_spacer() + p2 + dens_bd2 +
dens1 + plot_spacer() + p1 + dens2 +
plot_layout(
ncol = 2,
nrow = 4,
widths = c(4, 1),
heights = c(1, 4) ) ->
final_plot_bd
print(final_plot_bd)
# ggsave("Figure A4_V2.jpg", width = 6, height = 7, dpi = 300, units = "in")
lm(bd_test_data$log_kfs ~ bd_test_data$BulkDensity_gcm3) %>% summary()
print(final_plot_bd)
lm(bd_test_data$log_kfs ~ bd_test_data$BulkDensity_gcm3) %>% summary()
data_orig %>%
filter(!is.na(Unsaturated_K2cm_cmhr) & !is.na(Percent_Sand) &
!is.na(Type) & !is.na(Texture) & !is.na(BulkDensity_gcm3)) %>%
select(BulkDensity_gcm3, Unsaturated_K2cm_cmhr, Percent_Sand,
Percent_Silt, Percent_Clay, BulkDensity_gcm3, Texture) ->
bd_test_data
bd_test_data %>%
mutate(log_kfs = log(Unsaturated_K2cm_cmhr)) ->
bd_test_data
lm(bd_test_data$log_kfs ~ bd_test_data$BulkDensity_gcm3) %>% summary()
# density 1 panel
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3)) +
geom_histogram(bins = 30, fill = "white", col = "black") +
theme_void() ->
dens_bd1
# density 2 panel
bd_test_data %>%
ggplot(aes(log_kfs)) +
geom_histogram(bins = 20, fill = "white", col = "black") +
theme_void() +
coord_flip() ->
dens_bd2
bd_test_data %>%
ggplot(aes(BulkDensity_gcm3, log_kfs)) +
# geom_point() +
geom_hex(col = "gray", bins = 25) +
scale_fill_distiller(palette = "YlGnBu", name = "Count") +
labs(x = expression(Bulk~density~(g~cm^{-3})),
y = expression(K[fs]*","~log~(cm~h^{-1}))) ->
p2
dens_bd1 + plot_spacer() + p2 + dens_bd2 +
dens1 + plot_spacer() + p1 + dens2 +
plot_layout(
ncol = 2,
nrow = 4,
widths = c(4, 1),
heights = c(1, 4) ) ->
final_plot_bd
print(final_plot_bd)
# ggsave("Figure A4_V2.jpg", width = 6, height = 7, dpi = 300, units = "in")
View(bd_test_data)
View(bd_test_data)
ann_no_bd <- randomForest(log_kfs ~ Percent_Sand + Percent_Clay + Percent_Silt + Percent_Rock_Fragment, data=bd_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
rf_no_bd <- randomForest(log_kfs ~ Percent_Sand + Percent_Clay + Percent_Silt, data=bd_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
## train dataset
bd_test_data$rf_no_bd <- predict(rf_no_bd, bd_test_data)
cor(bd_test_data$rf_no_bd, bd_test_data$Unsaturated_K2cm_cmhr, method = c("spearman"))
m
summary(lm(bd_test_data$Unsaturated_K2cm_cmhr ~ bd_test_data$rf_no_bd))$r.squared %>%
round(2)
cor(bd_test_data$rf_no_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_no_bd))$r.squared %>%
round(2)
ann_ssc
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
neuralnet::compute(ann_no_bd, train[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])$net.result
neuralnet::compute(ann_no_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])$net.result
bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')]
neuralnet::compute(ann_no_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
ann_no_bd
# Set chunks defaults; these options will be applied to all subsequent chunks
knitr::opts_chunk$set(results = 'hide', message = TRUE, include = TRUE, echo = FALSE,
fig.height = 5, fig.width = 7)
# if(!file.exists(OUTPUT_DIR)) dir.create(OUTPUT_DIR)
# if(!file.exists(LOG_DIR)) dir.create( LOG_DIR )
library(cowplot)
library(grid)
library(gridExtra)
# install.packages("soiltexture")
# library( soiltexture )
library("ggpubr")
library(ggplot2)
# install.packages("randomForest")
library(randomForest)
# install.packages('neuralnet')
library(neuralnet)
library(reshape)
library(scales)
library(devtools)
library(dplyr)
library(readxl)
library(patchwork)
source('functions.R')
theme_set(theme_bw())
neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## ssc: with no scaled ssc
rf_no_bd <- randomForest(log_kfs ~ Percent_Sand + Percent_Clay + Percent_Silt, data=bd_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
## train dataset
bd_test_data$rf_no_bd <- predict(rf_no_bd, bd_test_data)
cor(bd_test_data$rf_no_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_no_bd))$r.squared %>%
round(2)
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## train dataset
bd_test_data$ann_no_bd <- neuralnet::compute(ann_no_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])$net.result
cor(bd_test_data$ann_no_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_no_bd))$r.squared %>%
round(2)
## ssc: with no scaled ssc
rf_no_bd <- randomForest(log_kfs ~ Percent_Sand + Percent_Clay + Percent_Silt, data=bd_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
## train dataset
bd_test_data$rf_no_bd <- predict(rf_no_bd, bd_test_data)
cor(bd_test_data$rf_no_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_no_bd))$r.squared %>%
round(2)
## ssc: with no scaled ssc, ann model
ann_no_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## train dataset
bd_test_data$ann_no_bd <- neuralnet::compute(ann_no_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])$net.result
cor(bd_test_data$ann_no_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_no_bd))$r.squared %>%
round(2)
## sscbd: with no scaled ssc
rf_wt_bd <- randomForest(log_kfs ~ Percent_Sand + Percent_Clay + Percent_Silt + BulkDensity_gcm3, data=bd_test_data,
ntree = 100,
mtry = 2,
importance = TRUE,
proximity = TRUE)
## train dataset
bd_test_data$rf_wt_bd <- predict(rf_wt_bd, bd_test_data)
cor(bd_test_data$rf_wt_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_wt_bd))$r.squared %>%
round(2)
## sscbd: with no scaled ssc, ann model
ann_wt_bd <- neuralnet(log_kfs ~ Percent_Sand + Percent_Silt + Percent_Clay + BulkDensity_gcm3,
data=bd_test_data, hidden=c(5,3), linear.output=T, stepmax=1e6)
## train dataset
bd_test_data$ann_wt_bd <- neuralnet::compute(ann_wt_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay')])$net.result
## train dataset
bd_test_data$ann_wt_bd <- neuralnet::compute(ann_wt_bd, bd_test_data[,c('Percent_Sand' , 'Percent_Silt' , 'Percent_Clay', 'BulkDensity_gcm3')])$net.result
cor(bd_test_data$ann_wt_bd, bd_test_data$log_kfs, method = c("spearman"))
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_wt_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_no_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_no_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_no_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$rf_wt_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_wt_bd))$r.squared %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_wt_bd))$r.squared.adj %>%
round(2)
summary(lm(bd_test_data$log_kfs ~ bd_test_data$ann_wt_bd))
bd_test_data %>% mutate(S_M1 = log_kfs - rf_no_bd) -> bd_test_data
slr_rf_np_bd <- lm(bd_test_data$log_kfs ~ bd_test_data$rf_no_bd)
tibble(inter = summary(slr_rf_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_np_bd)$adj.r.squared %>% round(2),
E = sum(subdata$S_M) / length(subdata$S_M) %>% round(3), #E
d = (1- sum(subdata$S_M^2)/sum((abs(subdata$mean-mean(subdata$observed_log))+abs(subdata$observed_log-mean(subdata$observed_log)))^2)) %>% round(3)
)
tibble(inter = summary(slr_rf_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_np_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M) / length(bd_test_data$S_M) %>% round(3), #E
d = (1- sum(bd_test_data$S_M^2)/sum((abs(bd_test_data$mean-mean(bd_test_data$observed_log))+
abs(bd_test_data$observed_log-mean(bd_test_data$observed_log)))^2)) %>% round(3)
)
tibble(inter = summary(slr_rf_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_np_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M) / length(bd_test_data$S_M) %>% round(3), #E
d = (1- sum(bd_test_data$S_M^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$rf_no_bd))+
abs(bd_test_data$rf_no_bd-mean(bd_test_data$rf_no_bd)))^2)) %>% round(3)
)
tibble(inter = summary(slr_rf_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_np_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M) / length(bd_test_data$S_M) %>% round(3), #E
RMSE = (sum(bd_test_data$S_M^2)/length(bd_test_data$S_M))^0.5 %>% round(3),
d = (1- sum(bd_test_data$S_M^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$rf_no_bd))+
abs(bd_test_data$rf_no_bd-mean(bd_test_data$rf_no_bd)))^2)) %>% round(3)
)
bd_test_data$S_M
tibble(inter = summary(slr_rf_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_np_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M1) / length(bd_test_data$S_M1) %>% round(3), #E
RMSE = (sum(bd_test_data$S_M1^2)/length(bd_test_data$S_M1))^0.5 %>% round(3),
d = (1- sum(bd_test_data$S_M1^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$rf_no_bd))+
abs(bd_test_data$rf_no_bd-mean(bd_test_data$rf_no_bd)))^2)) %>% round(3)
)
bd_test_data$S_M1
slr_ann_np_bd <- lm(bd_test_data$log_kfs ~ bd_test_data$ann_no_bd)
bd_test_data %>% mutate(S_M2 = log_kfs - ann_no_bd) -> bd_test_data
tibble(inter = summary(slr_ann_np_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_ann_np_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_ann_np_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M2) / length(bd_test_data$S_M2) %>% round(3), #E
RMSE = (sum(bd_test_data$S_M2^2)/length(bd_test_data$S_M2))^0.5 %>% round(3),
d = (1- sum(bd_test_data$S_M2^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$ann_no_bd))+
abs(bd_test_data$ann_no_bd-mean(bd_test_data$ann_no_bd)))^2)) %>% round(3)
)
cor(bd_test_data$rf_wt_bd, bd_test_data$log_kfs, method = c("spearman"))
bd_test_data %>% mutate(S_M3 = log_kfs - rf_wt_bd) -> bd_test_data
slr_rf_wt_bd <- lm(bd_test_data$log_kfs ~ bd_test_data$rf_wt_bd)
slr_rf_wt_bd <- lm(bd_test_data$log_kfs ~ bd_test_data$rf_wt_bd)
tibble(inter = summary(slr_rf_wt_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_rf_wt_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_rf_wt_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M3) / length(bd_test_data$S_M3) %>% round(3), #E
RMSE = (sum(bd_test_data$S_M3^2)/length(bd_test_data$S_M3))^0.5 %>% round(3),
d = (1- sum(bd_test_data$S_M3^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$rf_wt_bd))+
abs(bd_test_data$rf_wt_bd-mean(bd_test_data$rf_wt_bd)))^2)) %>% round(3)
)
slr_ann_wt_bd <- lm(bd_test_data$log_kfs ~ bd_test_data$ann_wt_bd)
bd_test_data %>% mutate(S_M3 = log_kfs - ann_wt_bd) -> bd_test_data
tibble(inter = summary(slr_ann_wt_bd)$coefficients[1,1] %>% round(3),
slope = summary(slr_ann_wt_bd)$coefficients[2,1] %>% round(3),
r2 = summary(slr_ann_wt_bd)$adj.r.squared %>% round(2),
E = sum(bd_test_data$S_M3) / length(bd_test_data$S_M3) %>% round(3), #E
RMSE = (sum(bd_test_data$S_M3^2)/length(bd_test_data$S_M3))^0.5 %>% round(3),
d = (1- sum(bd_test_data$S_M3^2)/sum((abs(bd_test_data$log_kfs-mean(bd_test_data$ann_wt_bd))+
abs(bd_test_data$ann_wt_bd-mean(bd_test_data$ann_wt_bd)))^2)) %>% round(3)
)
